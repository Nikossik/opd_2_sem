<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Оценка мышления</title>
    <link rel="stylesheet" href="ComparisonMindTest.css">
</head>
<body>
    <div id="container" class="container">
        <h1>Оценка мышления: Тест сравнения</h1>
        <button id="startButton" onclick="startTest(currentTestIndex)">Начать тест</button> <!-- Кнопка начала теста -->
        <img id="testImage" src="" alt="Тестовое изображение" style="display: none;">
        <div id="inputArea" style="display: none;">
            <input type="number" id="userInput" placeholder="Введите количество отличий">
            <button onclick="submitDifference()">Проверить</button>
        </div>
    </div>

    <script>
        const images = [
            { src: "img/easy1.png", correctDifferences: 5 },
            { src: "img/easy2.png", correctDifferences: 3 },
            { src: "img/medium1.png", correctDifferences: 4 },
            { src: "img/medium2.png", correctDifferences: 4 },
            { src: "img/hard1.png", correctDifferences: 12 },
            { src: "img/hard2.png", correctDifferences: 7 }
        ];

        let currentTestIndex = 0;
        const testDuration = [15, 15, 15]; // В секундах
        let results = []; // Сохраняем результаты пользователя
        let timer, inputTimer;

        function startTest(index) {
            document.getElementById('startButton').style.display = 'none'; // Скрываем кнопку "Начать тест"
            document.getElementById('testImage').style.display = 'block';
            document.getElementById('testImage').src = images[index].src;
            document.getElementById('inputArea').style.display = 'none'; // Скрываем окно ввода перед началом таймера
            
            // Показать окно ввода через 45 секунд
            inputTimer = setTimeout(() => {
                document.getElementById('inputArea').style.display = 'block';
            }, 5000);

            // Перейти к следующему тесту по истечению времени на вопрос
            timer = setTimeout(nextTest, testDuration[Math.floor(index / 2)] * 1000);
        }

        function nextTest() {
            clearTimeout(timer);
            clearTimeout(inputTimer);
            document.getElementById('inputArea').style.display = 'none'; // Скрываем окно ввода

            if (currentTestIndex < images.length - 1) {
                currentTestIndex++;
                startTest(currentTestIndex); // Начать следующий тест
            } else {
                showResults(); // Показать результаты, если это последний тест
            }
        }

        function showResults() {
            let resultHTML = "<h2>Результаты теста:</h2>";
            results.forEach((result, index) => {
                resultHTML += `<p>Вопрос ${index + 1}: Найдено ${result.found} из ${result.total} отличий.</p>`;
            });
            document.getElementById('container').innerHTML = resultHTML; // Убедитесь, что у вас есть элемент с id="container"
        }

        function submitDifference() {
            clearTimeout(timer);
            clearTimeout(inputTimer);
            const userDifference = parseInt(document.getElementById('userInput').value, 10);
            const correctDifference = images[currentTestIndex].correctDifferences;

            // Сохраняем результаты
            results.push({ found: userDifference, total: correctDifference });
            
            let message;
            if (userDifference === correctDifference) {
                message = "Вы правильно нашли все отличия!";
            } else if (userDifference < correctDifference) {
                message = `Вы нашли меньше на ${correctDifference - userDifference} отличий.`;
            } else {
                message = `${userDifference - correctDifference} отличий нет в действительности (лишние).`;
            }

            alert(message);
            document.getElementById('userInput').value = ''; // Очищаем поле ввода
            nextTest(); // Переход к следующему тесту
        }
    </script>
</body>
</html>